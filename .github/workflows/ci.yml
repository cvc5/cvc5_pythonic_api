on: [push, pull_request]
name: CI

jobs:
  build:
    runs-on: ubuntu-latest

    steps:

    - uses: actions/checkout@v2

    - uses: actions/checkout@v2
      with:
        repository: cvc5/cvc5
        path: cvc5
      
    - name: Install dependencies
      uses: cvc5/.github/actions/install-dependencies
      with:
        with-documentation: false
        with-python-bindings: true

    - name: Setup caches
      uses: cvc5/.github/actions/setup-cache
      with:
        cache-key: cvc5-z3py-compat

    - name: Configure and build
      id: configure-and-build
      uses: cvc5/.github/actions/configure-and-build
      with:
        configure-config: production --auto-download --python-bindings
        build-static: false

    - name: Test z3py compatibility API
      run: |
        make test
